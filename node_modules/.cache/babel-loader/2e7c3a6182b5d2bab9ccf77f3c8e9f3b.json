{"ast":null,"code":"'use strict';\n\nvar $scope,\n    conflict,\n    conflictResolution = [];\n\nif (typeof global === 'object' && global) {\n  $scope = global;\n} else if (typeof window !== 'undefined') {\n  $scope = window;\n} else {\n  $scope = {};\n}\n\nconflict = $scope.DeepDiff;\n\nif (conflict) {\n  conflictResolution.push(function () {\n    if ('undefined' !== typeof conflict && $scope.DeepDiff === accumulateDiff) {\n      $scope.DeepDiff = conflict;\n      conflict = undefined;\n    }\n  });\n} // nodejs compatible on server side and in the browser.\n\n\nfunction inherits(ctor, superCtor) {\n  ctor.super_ = superCtor;\n  ctor.prototype = Object.create(superCtor.prototype, {\n    constructor: {\n      value: ctor,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n}\n\nfunction Diff(kind, path) {\n  Object.defineProperty(this, 'kind', {\n    value: kind,\n    enumerable: true\n  });\n\n  if (path && path.length) {\n    Object.defineProperty(this, 'path', {\n      value: path,\n      enumerable: true\n    });\n  }\n}\n\nfunction DiffEdit(path, origin, value) {\n  DiffEdit.super_.call(this, 'E', path);\n  Object.defineProperty(this, 'lhs', {\n    value: origin,\n    enumerable: true\n  });\n  Object.defineProperty(this, 'rhs', {\n    value: value,\n    enumerable: true\n  });\n}\n\ninherits(DiffEdit, Diff);\n\nfunction DiffNew(path, value) {\n  DiffNew.super_.call(this, 'N', path);\n  Object.defineProperty(this, 'rhs', {\n    value: value,\n    enumerable: true\n  });\n}\n\ninherits(DiffNew, Diff);\n\nfunction DiffDeleted(path, value) {\n  DiffDeleted.super_.call(this, 'D', path);\n  Object.defineProperty(this, 'lhs', {\n    value: value,\n    enumerable: true\n  });\n}\n\ninherits(DiffDeleted, Diff);\n\nfunction DiffArray(path, index, item) {\n  DiffArray.super_.call(this, 'A', path);\n  Object.defineProperty(this, 'index', {\n    value: index,\n    enumerable: true\n  });\n  Object.defineProperty(this, 'item', {\n    value: item,\n    enumerable: true\n  });\n}\n\ninherits(DiffArray, Diff);\n\nfunction arrayRemove(arr, from, to) {\n  var rest = arr.slice((to || from) + 1 || arr.length);\n  arr.length = from < 0 ? arr.length + from : from;\n  arr.push.apply(arr, rest);\n  return arr;\n}\n\nfunction realTypeOf(subject) {\n  var type = typeof subject;\n\n  if (type !== 'object') {\n    return type;\n  }\n\n  if (subject === Math) {\n    return 'math';\n  } else if (subject === null) {\n    return 'null';\n  } else if (Array.isArray(subject)) {\n    return 'array';\n  } else if (Object.prototype.toString.call(subject) === '[object Date]') {\n    return 'date';\n  } else if (typeof subject.toString === 'function' && /^\\/.*\\//.test(subject.toString())) {\n    return 'regexp';\n  }\n\n  return 'object';\n}\n\nfunction deepDiff(lhs, rhs, changes, prefilter, path, key, stack) {\n  path = path || [];\n  stack = stack || [];\n  var currentPath = path.slice(0);\n\n  if (typeof key !== 'undefined') {\n    if (prefilter) {\n      if (typeof prefilter === 'function' && prefilter(currentPath, key)) {\n        return;\n      } else if (typeof prefilter === 'object') {\n        if (prefilter.prefilter && prefilter.prefilter(currentPath, key)) {\n          return;\n        }\n\n        if (prefilter.normalize) {\n          var alt = prefilter.normalize(currentPath, key, lhs, rhs);\n\n          if (alt) {\n            lhs = alt[0];\n            rhs = alt[1];\n          }\n        }\n      }\n    }\n\n    currentPath.push(key);\n  } // Use string comparison for regexes\n\n\n  if (realTypeOf(lhs) === 'regexp' && realTypeOf(rhs) === 'regexp') {\n    lhs = lhs.toString();\n    rhs = rhs.toString();\n  }\n\n  var ltype = typeof lhs;\n  var rtype = typeof rhs;\n  var ldefined = ltype !== 'undefined' || stack && stack[stack.length - 1].lhs && stack[stack.length - 1].lhs.hasOwnProperty(key);\n  var rdefined = rtype !== 'undefined' || stack && stack[stack.length - 1].rhs && stack[stack.length - 1].rhs.hasOwnProperty(key);\n\n  if (!ldefined && rdefined) {\n    changes(new DiffNew(currentPath, rhs));\n  } else if (!rdefined && ldefined) {\n    changes(new DiffDeleted(currentPath, lhs));\n  } else if (realTypeOf(lhs) !== realTypeOf(rhs)) {\n    changes(new DiffEdit(currentPath, lhs, rhs));\n  } else if (realTypeOf(lhs) === 'date' && lhs - rhs !== 0) {\n    changes(new DiffEdit(currentPath, lhs, rhs));\n  } else if (ltype === 'object' && lhs !== null && rhs !== null) {\n    if (!stack.filter(function (x) {\n      return x.lhs === lhs;\n    }).length) {\n      stack.push({\n        lhs: lhs,\n        rhs: rhs\n      });\n\n      if (Array.isArray(lhs)) {\n        var i,\n            len = lhs.length;\n\n        for (i = 0; i < lhs.length; i++) {\n          if (i >= rhs.length) {\n            changes(new DiffArray(currentPath, i, new DiffDeleted(undefined, lhs[i])));\n          } else {\n            deepDiff(lhs[i], rhs[i], changes, prefilter, currentPath, i, stack);\n          }\n        }\n\n        while (i < rhs.length) {\n          changes(new DiffArray(currentPath, i, new DiffNew(undefined, rhs[i++])));\n        }\n      } else {\n        var akeys = Object.keys(lhs);\n        var pkeys = Object.keys(rhs);\n        akeys.forEach(function (k, i) {\n          var other = pkeys.indexOf(k);\n\n          if (other >= 0) {\n            deepDiff(lhs[k], rhs[k], changes, prefilter, currentPath, k, stack);\n            pkeys = arrayRemove(pkeys, other);\n          } else {\n            deepDiff(lhs[k], undefined, changes, prefilter, currentPath, k, stack);\n          }\n        });\n        pkeys.forEach(function (k) {\n          deepDiff(undefined, rhs[k], changes, prefilter, currentPath, k, stack);\n        });\n      }\n\n      stack.length = stack.length - 1;\n    } else if (lhs !== rhs) {\n      // lhs is contains a cycle at this element and it differs from rhs\n      changes(new DiffEdit(currentPath, lhs, rhs));\n    }\n  } else if (lhs !== rhs) {\n    if (!(ltype === 'number' && isNaN(lhs) && isNaN(rhs))) {\n      changes(new DiffEdit(currentPath, lhs, rhs));\n    }\n  }\n}\n\nfunction accumulateDiff(lhs, rhs, prefilter, accum) {\n  accum = accum || [];\n  deepDiff(lhs, rhs, function (diff) {\n    if (diff) {\n      accum.push(diff);\n    }\n  }, prefilter);\n  return accum.length ? accum : undefined;\n}\n\nfunction applyArrayChange(arr, index, change) {\n  if (change.path && change.path.length) {\n    var it = arr[index],\n        i,\n        u = change.path.length - 1;\n\n    for (i = 0; i < u; i++) {\n      it = it[change.path[i]];\n    }\n\n    switch (change.kind) {\n      case 'A':\n        applyArrayChange(it[change.path[i]], change.index, change.item);\n        break;\n\n      case 'D':\n        delete it[change.path[i]];\n        break;\n\n      case 'E':\n      case 'N':\n        it[change.path[i]] = change.rhs;\n        break;\n    }\n  } else {\n    switch (change.kind) {\n      case 'A':\n        applyArrayChange(arr[index], change.index, change.item);\n        break;\n\n      case 'D':\n        arr = arrayRemove(arr, index);\n        break;\n\n      case 'E':\n      case 'N':\n        arr[index] = change.rhs;\n        break;\n    }\n  }\n\n  return arr;\n}\n\nfunction applyChange(target, source, change) {\n  if (target && source && change && change.kind) {\n    var it = target,\n        i = -1,\n        last = change.path ? change.path.length - 1 : 0;\n\n    while (++i < last) {\n      if (typeof it[change.path[i]] === 'undefined') {\n        it[change.path[i]] = typeof change.path[i] === 'number' ? [] : {};\n      }\n\n      it = it[change.path[i]];\n    }\n\n    switch (change.kind) {\n      case 'A':\n        applyArrayChange(change.path ? it[change.path[i]] : it, change.index, change.item);\n        break;\n\n      case 'D':\n        delete it[change.path[i]];\n        break;\n\n      case 'E':\n      case 'N':\n        it[change.path[i]] = change.rhs;\n        break;\n    }\n  }\n}\n\nfunction revertArrayChange(arr, index, change) {\n  if (change.path && change.path.length) {\n    // the structure of the object at the index has changed...\n    var it = arr[index],\n        i,\n        u = change.path.length - 1;\n\n    for (i = 0; i < u; i++) {\n      it = it[change.path[i]];\n    }\n\n    switch (change.kind) {\n      case 'A':\n        revertArrayChange(it[change.path[i]], change.index, change.item);\n        break;\n\n      case 'D':\n        it[change.path[i]] = change.lhs;\n        break;\n\n      case 'E':\n        it[change.path[i]] = change.lhs;\n        break;\n\n      case 'N':\n        delete it[change.path[i]];\n        break;\n    }\n  } else {\n    // the array item is different...\n    switch (change.kind) {\n      case 'A':\n        revertArrayChange(arr[index], change.index, change.item);\n        break;\n\n      case 'D':\n        arr[index] = change.lhs;\n        break;\n\n      case 'E':\n        arr[index] = change.lhs;\n        break;\n\n      case 'N':\n        arr = arrayRemove(arr, index);\n        break;\n    }\n  }\n\n  return arr;\n}\n\nfunction revertChange(target, source, change) {\n  if (target && source && change && change.kind) {\n    var it = target,\n        i,\n        u;\n    u = change.path.length - 1;\n\n    for (i = 0; i < u; i++) {\n      if (typeof it[change.path[i]] === 'undefined') {\n        it[change.path[i]] = {};\n      }\n\n      it = it[change.path[i]];\n    }\n\n    switch (change.kind) {\n      case 'A':\n        // Array was modified...\n        // it will be an array...\n        revertArrayChange(it[change.path[i]], change.index, change.item);\n        break;\n\n      case 'D':\n        // Item was deleted...\n        it[change.path[i]] = change.lhs;\n        break;\n\n      case 'E':\n        // Item was edited...\n        it[change.path[i]] = change.lhs;\n        break;\n\n      case 'N':\n        // Item is new...\n        delete it[change.path[i]];\n        break;\n    }\n  }\n}\n\nfunction applyDiff(target, source, filter) {\n  if (target && source) {\n    var onChange = function (change) {\n      if (!filter || filter(target, source, change)) {\n        applyChange(target, source, change);\n      }\n    };\n\n    deepDiff(target, source, onChange);\n  }\n}\n\nObject.defineProperties(accumulateDiff, {\n  diff: {\n    value: accumulateDiff,\n    enumerable: true\n  },\n  observableDiff: {\n    value: deepDiff,\n    enumerable: true\n  },\n  applyDiff: {\n    value: applyDiff,\n    enumerable: true\n  },\n  applyChange: {\n    value: applyChange,\n    enumerable: true\n  },\n  revertChange: {\n    value: revertChange,\n    enumerable: true\n  },\n  isConflict: {\n    value: function () {\n      return 'undefined' !== typeof conflict;\n    },\n    enumerable: true\n  },\n  noConflict: {\n    value: function () {\n      if (conflictResolution) {\n        conflictResolution.forEach(function (it) {\n          it();\n        });\n        conflictResolution = null;\n      }\n\n      return accumulateDiff;\n    },\n    enumerable: true\n  }\n});\nexport default accumulateDiff;","map":{"version":3,"sources":["/Users/user/Desktop/robofriends/node_modules/deep-diff/index.es.js"],"names":["$scope","conflict","conflictResolution","global","window","DeepDiff","push","accumulateDiff","undefined","inherits","ctor","superCtor","super_","prototype","Object","create","constructor","value","enumerable","writable","configurable","Diff","kind","path","defineProperty","length","DiffEdit","origin","call","DiffNew","DiffDeleted","DiffArray","index","item","arrayRemove","arr","from","to","rest","slice","apply","realTypeOf","subject","type","Math","Array","isArray","toString","test","deepDiff","lhs","rhs","changes","prefilter","key","stack","currentPath","normalize","alt","ltype","rtype","ldefined","hasOwnProperty","rdefined","filter","x","i","len","akeys","keys","pkeys","forEach","k","other","indexOf","isNaN","accum","diff","applyArrayChange","change","it","u","applyChange","target","source","last","revertArrayChange","revertChange","applyDiff","onChange","defineProperties","observableDiff","isConflict","noConflict"],"mappings":"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","sourcesContent":["'use strict';\nvar $scope, conflict, conflictResolution = [];\nif (typeof global === 'object' && global) {\n  $scope = global;\n} else if (typeof window !== 'undefined') {\n  $scope = window;\n} else {\n  $scope = {};\n}\nconflict = $scope.DeepDiff;\nif (conflict) {\n  conflictResolution.push(\n    function() {\n      if ('undefined' !== typeof conflict && $scope.DeepDiff === accumulateDiff) {\n        $scope.DeepDiff = conflict;\n        conflict = undefined;\n      }\n    });\n}\n\n// nodejs compatible on server side and in the browser.\nfunction inherits(ctor, superCtor) {\n  ctor.super_ = superCtor;\n  ctor.prototype = Object.create(superCtor.prototype, {\n    constructor: {\n      value: ctor,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n}\n\nfunction Diff(kind, path) {\n  Object.defineProperty(this, 'kind', {\n    value: kind,\n    enumerable: true\n  });\n  if (path && path.length) {\n    Object.defineProperty(this, 'path', {\n      value: path,\n      enumerable: true\n    });\n  }\n}\n\nfunction DiffEdit(path, origin, value) {\n  DiffEdit.super_.call(this, 'E', path);\n  Object.defineProperty(this, 'lhs', {\n    value: origin,\n    enumerable: true\n  });\n  Object.defineProperty(this, 'rhs', {\n    value: value,\n    enumerable: true\n  });\n}\ninherits(DiffEdit, Diff);\n\nfunction DiffNew(path, value) {\n  DiffNew.super_.call(this, 'N', path);\n  Object.defineProperty(this, 'rhs', {\n    value: value,\n    enumerable: true\n  });\n}\ninherits(DiffNew, Diff);\n\nfunction DiffDeleted(path, value) {\n  DiffDeleted.super_.call(this, 'D', path);\n  Object.defineProperty(this, 'lhs', {\n    value: value,\n    enumerable: true\n  });\n}\ninherits(DiffDeleted, Diff);\n\nfunction DiffArray(path, index, item) {\n  DiffArray.super_.call(this, 'A', path);\n  Object.defineProperty(this, 'index', {\n    value: index,\n    enumerable: true\n  });\n  Object.defineProperty(this, 'item', {\n    value: item,\n    enumerable: true\n  });\n}\ninherits(DiffArray, Diff);\n\nfunction arrayRemove(arr, from, to) {\n  var rest = arr.slice((to || from) + 1 || arr.length);\n  arr.length = from < 0 ? arr.length + from : from;\n  arr.push.apply(arr, rest);\n  return arr;\n}\n\nfunction realTypeOf(subject) {\n  var type = typeof subject;\n  if (type !== 'object') {\n    return type;\n  }\n\n  if (subject === Math) {\n    return 'math';\n  } else if (subject === null) {\n    return 'null';\n  } else if (Array.isArray(subject)) {\n    return 'array';\n  } else if (Object.prototype.toString.call(subject) === '[object Date]') {\n    return 'date';\n  } else if (typeof subject.toString === 'function' && /^\\/.*\\//.test(subject.toString())) {\n    return 'regexp';\n  }\n  return 'object';\n}\n\nfunction deepDiff(lhs, rhs, changes, prefilter, path, key, stack) {\n  path = path || [];\n  stack = stack || [];\n  var currentPath = path.slice(0);\n  if (typeof key !== 'undefined') {\n    if (prefilter) {\n      if (typeof(prefilter) === 'function' && prefilter(currentPath, key)) {\n        return; } else if (typeof(prefilter) === 'object') {\n        if (prefilter.prefilter && prefilter.prefilter(currentPath, key)) {\n          return; }\n        if (prefilter.normalize) {\n          var alt = prefilter.normalize(currentPath, key, lhs, rhs);\n          if (alt) {\n            lhs = alt[0];\n            rhs = alt[1];\n          }\n        }\n      }\n    }\n    currentPath.push(key);\n  }\n\n  // Use string comparison for regexes\n  if (realTypeOf(lhs) === 'regexp' && realTypeOf(rhs) === 'regexp') {\n    lhs = lhs.toString();\n    rhs = rhs.toString();\n  }\n\n  var ltype = typeof lhs;\n  var rtype = typeof rhs;\n\n  var ldefined = ltype !== 'undefined' || (stack && stack[stack.length - 1].lhs && stack[stack.length - 1].lhs.hasOwnProperty(key));\n  var rdefined = rtype !== 'undefined' || (stack && stack[stack.length - 1].rhs && stack[stack.length - 1].rhs.hasOwnProperty(key));\n\n  if (!ldefined && rdefined) {\n    changes(new DiffNew(currentPath, rhs));\n  } else if (!rdefined && ldefined) {\n    changes(new DiffDeleted(currentPath, lhs));\n  } else if (realTypeOf(lhs) !== realTypeOf(rhs)) {\n    changes(new DiffEdit(currentPath, lhs, rhs));\n  } else if (realTypeOf(lhs) === 'date' && (lhs - rhs) !== 0) {\n    changes(new DiffEdit(currentPath, lhs, rhs));\n  } else if (ltype === 'object' && lhs !== null && rhs !== null) {\n    if (!stack.filter(function(x) {\n        return x.lhs === lhs; }).length) {\n      stack.push({ lhs: lhs, rhs: rhs });\n      if (Array.isArray(lhs)) {\n        var i, len = lhs.length;\n        for (i = 0; i < lhs.length; i++) {\n          if (i >= rhs.length) {\n            changes(new DiffArray(currentPath, i, new DiffDeleted(undefined, lhs[i])));\n          } else {\n            deepDiff(lhs[i], rhs[i], changes, prefilter, currentPath, i, stack);\n          }\n        }\n        while (i < rhs.length) {\n          changes(new DiffArray(currentPath, i, new DiffNew(undefined, rhs[i++])));\n        }\n      } else {\n        var akeys = Object.keys(lhs);\n        var pkeys = Object.keys(rhs);\n        akeys.forEach(function(k, i) {\n          var other = pkeys.indexOf(k);\n          if (other >= 0) {\n            deepDiff(lhs[k], rhs[k], changes, prefilter, currentPath, k, stack);\n            pkeys = arrayRemove(pkeys, other);\n          } else {\n            deepDiff(lhs[k], undefined, changes, prefilter, currentPath, k, stack);\n          }\n        });\n        pkeys.forEach(function(k) {\n          deepDiff(undefined, rhs[k], changes, prefilter, currentPath, k, stack);\n        });\n      }\n      stack.length = stack.length - 1;\n    } else if (lhs !== rhs) {\n      // lhs is contains a cycle at this element and it differs from rhs\n      changes(new DiffEdit(currentPath, lhs, rhs));\n    }\n  } else if (lhs !== rhs) {\n    if (!(ltype === 'number' && isNaN(lhs) && isNaN(rhs))) {\n      changes(new DiffEdit(currentPath, lhs, rhs));\n    }\n  }\n}\n\nfunction accumulateDiff(lhs, rhs, prefilter, accum) {\n  accum = accum || [];\n  deepDiff(lhs, rhs,\n    function(diff) {\n      if (diff) {\n        accum.push(diff);\n      }\n    },\n    prefilter);\n  return (accum.length) ? accum : undefined;\n}\n\nfunction applyArrayChange(arr, index, change) {\n  if (change.path && change.path.length) {\n    var it = arr[index],\n      i, u = change.path.length - 1;\n    for (i = 0; i < u; i++) {\n      it = it[change.path[i]];\n    }\n    switch (change.kind) {\n      case 'A':\n        applyArrayChange(it[change.path[i]], change.index, change.item);\n        break;\n      case 'D':\n        delete it[change.path[i]];\n        break;\n      case 'E':\n      case 'N':\n        it[change.path[i]] = change.rhs;\n        break;\n    }\n  } else {\n    switch (change.kind) {\n      case 'A':\n        applyArrayChange(arr[index], change.index, change.item);\n        break;\n      case 'D':\n        arr = arrayRemove(arr, index);\n        break;\n      case 'E':\n      case 'N':\n        arr[index] = change.rhs;\n        break;\n    }\n  }\n  return arr;\n}\n\nfunction applyChange(target, source, change) {\n  if (target && source && change && change.kind) {\n    var it = target,\n      i = -1,\n      last = change.path ? change.path.length - 1 : 0;\n    while (++i < last) {\n      if (typeof it[change.path[i]] === 'undefined') {\n        it[change.path[i]] = (typeof change.path[i] === 'number') ? [] : {};\n      }\n      it = it[change.path[i]];\n    }\n    switch (change.kind) {\n      case 'A':\n        applyArrayChange(change.path ? it[change.path[i]] : it, change.index, change.item);\n        break;\n      case 'D':\n        delete it[change.path[i]];\n        break;\n      case 'E':\n      case 'N':\n        it[change.path[i]] = change.rhs;\n        break;\n    }\n  }\n}\n\nfunction revertArrayChange(arr, index, change) {\n  if (change.path && change.path.length) {\n    // the structure of the object at the index has changed...\n    var it = arr[index],\n      i, u = change.path.length - 1;\n    for (i = 0; i < u; i++) {\n      it = it[change.path[i]];\n    }\n    switch (change.kind) {\n      case 'A':\n        revertArrayChange(it[change.path[i]], change.index, change.item);\n        break;\n      case 'D':\n        it[change.path[i]] = change.lhs;\n        break;\n      case 'E':\n        it[change.path[i]] = change.lhs;\n        break;\n      case 'N':\n        delete it[change.path[i]];\n        break;\n    }\n  } else {\n    // the array item is different...\n    switch (change.kind) {\n      case 'A':\n        revertArrayChange(arr[index], change.index, change.item);\n        break;\n      case 'D':\n        arr[index] = change.lhs;\n        break;\n      case 'E':\n        arr[index] = change.lhs;\n        break;\n      case 'N':\n        arr = arrayRemove(arr, index);\n        break;\n    }\n  }\n  return arr;\n}\n\nfunction revertChange(target, source, change) {\n  if (target && source && change && change.kind) {\n    var it = target,\n      i, u;\n    u = change.path.length - 1;\n    for (i = 0; i < u; i++) {\n      if (typeof it[change.path[i]] === 'undefined') {\n        it[change.path[i]] = {};\n      }\n      it = it[change.path[i]];\n    }\n    switch (change.kind) {\n      case 'A':\n        // Array was modified...\n        // it will be an array...\n        revertArrayChange(it[change.path[i]], change.index, change.item);\n        break;\n      case 'D':\n        // Item was deleted...\n        it[change.path[i]] = change.lhs;\n        break;\n      case 'E':\n        // Item was edited...\n        it[change.path[i]] = change.lhs;\n        break;\n      case 'N':\n        // Item is new...\n        delete it[change.path[i]];\n        break;\n    }\n  }\n}\n\nfunction applyDiff(target, source, filter) {\n  if (target && source) {\n    var onChange = function(change) {\n      if (!filter || filter(target, source, change)) {\n        applyChange(target, source, change);\n      }\n    };\n    deepDiff(target, source, onChange);\n  }\n}\n\nObject.defineProperties(accumulateDiff, {\n\n  diff: {\n    value: accumulateDiff,\n    enumerable: true\n  },\n  observableDiff: {\n    value: deepDiff,\n    enumerable: true\n  },\n  applyDiff: {\n    value: applyDiff,\n    enumerable: true\n  },\n  applyChange: {\n    value: applyChange,\n    enumerable: true\n  },\n  revertChange: {\n    value: revertChange,\n    enumerable: true\n  },\n  isConflict: {\n    value: function() {\n      return 'undefined' !== typeof conflict;\n    },\n    enumerable: true\n  },\n  noConflict: {\n    value: function() {\n      if (conflictResolution) {\n        conflictResolution.forEach(function(it) {\n          it();\n        });\n        conflictResolution = null;\n      }\n      return accumulateDiff;\n    },\n    enumerable: true\n  }\n});\n\nexport default accumulateDiff;\n"]},"metadata":{},"sourceType":"module"}